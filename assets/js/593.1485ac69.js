(window.webpackJsonp=window.webpackJsonp||[]).push([[593],{1224:function(s,t,a){"use strict";a.r(t);var e=a(12),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ubuntu2004启用休眠-hibernate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu2004启用休眠-hibernate"}},[s._v("#")]),s._v(" Ubuntu20.04启用休眠-hibernate")]),s._v(" "),a("h2",{attrs:{id:"在系统中启用休眠功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在系统中启用休眠功能"}},[s._v("#")]),s._v(" 在系统中启用休眠功能")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("更加详细的参考")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://fitzcarraldoblog.wordpress.com/2018/07/14/configuring-lubuntu-18-04-to-enable-hibernation-using-a-swap-file/",target:"_blank",rel:"noopener noreferrer"}},[s._v("configuring-lubuntu-18-04-to-enable-hibernation-using-a-swap-file"),a("OutboundLink")],1)])])]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("方法")]),s._v(" "),a("p",[s._v("I assume you have a swap "),a("strong",[s._v("partition")]),s._v(" ready to use.\n(If you have a swap "),a("strong",[s._v("file")]),s._v(" you cannot hibernate)")]),s._v(" "),a("p",[s._v("Install "),a("code",[s._v("pm-utils")]),s._v(" and "),a("code",[s._v("hibernate")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pm-utils hibernate\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Then:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /sys/power/state\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("You should see:")]),s._v(" "),a("div",{staticClass:"language-none line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("freeze mem disk\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Then run:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" swap /etc/fstab\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Copy the UUID value. You will need it later. Then run:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("code /etc/default/grub\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("(or your favorite editor if not VScode). Change the line that says")]),s._v(" "),a("div",{staticClass:"language-none line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("so that it instead says:")]),s._v(" "),a("div",{staticClass:"language-none line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('GRUB_CMDLINE_LINUX_DEFAULT="quiet splash resume=UUID=YOUR_VALUE"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Then, after saving the file and quitting the text editor, run:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("update-grub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("To test it, run:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl hibernate\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Right now no GNOME extension is working to have the hibernate option back in the system menu.")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://askubuntu.com/a/1241902/1088633",target:"_blank",rel:"noopener noreferrer"}},[s._v("how-to-enable-hibernate-option-in-ubuntu-20-04"),a("OutboundLink")],1)])]),s._v(" "),a("ul",[a("li",[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("确保 Swap 分区要比内存容量要大")])])]),s._v(" "),a("li",[a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("Swap 分区的相关设置")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.fosslinux.com/1064/how-to-create-or-add-a-swap-partition-in-ubuntu-and-linux-mint.htm",target:"_blank",rel:"noopener noreferrer"}},[s._v("新建 Swap 分区"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("如果 Swap 分区已存在, 则需先运行 "),a("code",[s._v("sudo swapoff /swapfile")]),s._v(" 来关闭当前分区")])])])])])]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("重启后黑屏的解决办法")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("添加 "),a("code",[s._v("resumedelay")]),s._v(" 选项，以确保 "),a("code",[s._v("swap file")]),s._v(" 有充足的时间变得可读写")]),s._v(" "),a("div",{staticClass:"language-none line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('GRUB_CMDLINE_LINUX_DEFAULT="quiet splash resume=UUID=27c000dd-892e-4aaa-b938-349c13e3f50c resumedelay=8"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("之后，更新 "),a("code",[s._v("grub")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("update-grub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://fitzcarraldoblog.wordpress.com/2018/07/14/configuring-lubuntu-18-04-to-enable-hibernation-using-a-swap-file/",target:"_blank",rel:"noopener noreferrer"}},[s._v("configuring-lubuntu-18-04-to-enable-hibernation-using-a-swap-file"),a("OutboundLink")],1)])])]),s._v(" "),a("h2",{attrs:{id:"添加-hibernate-选项至关机界面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加-hibernate-选项至关机界面"}},[s._v("#")]),s._v(" 添加 hibernate 选项至关机界面")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("方法")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("使用 gnome 插件 "),a("a",{attrs:{href:"https://extensions.gnome.org/extension/3070/simpler-off-menu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("simpler-off-menu"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[a("blockquote",[a("p",[a("RouterLink",{attrs:{to:"/pages/dfacb5/#gnome-安装插件的方法"}},[s._v("安装插件的方法")])],1)])])])]),s._v(" "),a("li",[a("p",[s._v("在其设置界面即可启 "),a("code",[s._v("hibernate")]),s._v(" 选项")]),s._v(" "),a("ul",[a("li",[s._v("设置完成后需要重启 gnome 桌面\n"),a("ul",[a("li",[a("blockquote",[a("p",[a("RouterLink",{attrs:{to:"/pages/dfacb5/#重启-gnome-的方法"}},[s._v("重启 gnome 的方法")])],1)])])])])])])])]),s._v(" "),a("h2",{attrs:{id:"从休眠状态恢复后不需要密码就能显示桌面的解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从休眠状态恢复后不需要密码就能显示桌面的解决方案"}},[s._v("#")]),s._v(" 从休眠状态恢复后不需要密码就能显示桌面的解决方案")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("解决问题思路")]),s._v(" "),a("ul",[a("li",[s._v("刚开始的思路是修改系统服务，但是发现用于锁屏的命令"),a("code",[s._v("gnome-screensaver-command -l")]),s._v("总是提示跟 "),a("code",[s._v("ibus")]),s._v(" 相关的错误，暂时未找到解决方案\n"),a("ul",[a("li",[s._v("可能是 "),a("code",[s._v("environment")]),s._v(" 设置的问题 ⌛tag+todo")])])]),s._v(" "),a("li",[s._v("所以，中间就考虑用脚本解决")]),s._v(" "),a("li",[s._v("最后发现也可以改写 "),a("code",[s._v("gnome-extension")]),s._v("，使其中的 "),a("code",[s._v("hibernate")]),s._v(" 按钮在休眠状态恢复后进入锁屏")])])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("为了使用命令行锁屏，首先需要安装 "),a("code",[s._v("gnome-screensaver")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gnome-screensaver\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("h3",{attrs:{id:"用脚本进行休眠"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用脚本进行休眠"}},[s._v("#")]),s._v(" 用脚本进行休眠")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("脚本文件如下")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"----------进入休眠状态----------"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" /usr/bin/gnome-screensaver-command --lock "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl hibernate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"----------从休眠状态恢复---------"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("可以使用 "),a("code",[s._v("alias")]),s._v(" 命令在 "),a("code",[s._v("~/.zshrc")]),s._v(" 中自定义休眠所用的命令\n"),a("ul",[a("li",[s._v("如 "),a("code",[s._v("alias hibernate='~/OneDrive/SyncFile/scripts/shell/hibernate.sh'")])])])])])]),s._v(" "),a("h3",{attrs:{id:"修改-simpler-off-menu-使得-hibernate-按钮也有相同的功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-simpler-off-menu-使得-hibernate-按钮也有相同的功能"}},[s._v("#")]),s._v(" 修改 simpler-off-menu, 使得 "),a("code",[s._v("hibernate")]),s._v(" 按钮也有相同的功能")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("解决步骤")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("gnome extension")]),s._v(" 的本地文件夹")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("在 "),a("code",[s._v("~/.local/share/gnome-shell/extensions/SimplerOffMenu.kerkus@pm.me/")])])]),s._v(" "),a("li",[a("p",[s._v("修改 "),a("code",[s._v("extension.js")]),s._v(", 将其 "),a("code",[s._v("FuncHibernate")]),s._v(" 函数改为如下形式")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("FuncHibernate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("widget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  Main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("overview"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hide")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("spawn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"systemctl hibernate && /usr/bin/gnome-screensaver-command -l"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[s._v("修改完成后，按 "),a("code",[s._v("Alt+F2")]),s._v(" 输入 "),a("code",[s._v("r")]),s._v(" 重启 "),a("code",[s._v("gnome")]),s._v(" 后即可生效")])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);