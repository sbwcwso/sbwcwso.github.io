(window.webpackJsonp=window.webpackJsonp||[]).push([[266],{815:function(t,s,a){"use strict";a.r(s);var c=a(12),l=function(t){t.options.__data__block__={markmap_1a96284d:"- [面向连接传输协议TCP](#面向连接传输协议tcp)\n  - [TCP 连接概述](#tcp-连接概述)\n  - [TCP 报文段结构](#tcp-报文段结构)\n  - [往返时间的估计和超时](#往返时间的估计和超时)\n  - [TCP 可靠数据传输](#tcp-可靠数据传输)\n    - [TCP 发送方事件](#tcp-发送方事件)\n    - [TCP ACK 生成[RFC 568]](#tcp-ack-生成rfc-568)\n    - [快速重传机制](#快速重传机制)\n  - [TCP 流量控制](#tcp-流量控制)\n  - [TCP 连接管理](#tcp-连接管理)"}},v=Object(c.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"面向连接传输协议tcp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#面向连接传输协议tcp"}},[t._v("#")]),t._v(" 面向连接传输协议TCP")]),t._v(" "),a("Markmap",{attrs:{id:"markmap_1a96284d",code:t.$dataBlock.markmap_1a96284d}}),a("h2",{attrs:{id:"tcp-连接概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-连接概述"}},[t._v("#")]),t._v(" TCP 连接概述")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("TCP 概述")])]),t._v(" "),a("h2",{attrs:{id:"tcp-报文段结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-报文段结构"}},[t._v("#")]),t._v(" TCP 报文段结构")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210902150451-2021-09-02-15-04-51.png",alt:"20210902150451-2021-09-02-15-04-51"}})]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("TCP: 序列号和 ACK")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("序列号")]),t._v(" "),a("ul",[a("li",[t._v("序列号指的是segment中第一个字节的编号，而不是segment的编号")]),t._v(" "),a("li",[t._v("建立TCP连接时，双方随机选择初始的序列号")])])]),t._v(" "),a("li",[a("p",[t._v("ACKs")]),t._v(" "),a("ul",[a("li",[t._v("希望接收到的下一个字节的序列号")]),t._v(" "),a("li",[t._v("累计确认：该序列号之前的所有字节均已被正确接收到")])])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("接收方如何处理乱序到达的Segment？")]),t._v(" "),a("ul",[a("li",[t._v("TCP规范中没有规定，由TCP的实现者做出决策")]),t._v(" "),a("li",[t._v("一般会对乱存到达的 Segment 进行缓存")])])])]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("简单 telnet 示例")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210902151149-2021-09-02-15-11-49.png",alt:"20210902151149-2021-09-02-15-11-49"}})])]),t._v(" "),a("h2",{attrs:{id:"往返时间的估计和超时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#往返时间的估计和超时"}},[t._v("#")]),t._v(" 往返时间的估计和超时")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("如何设置定时器的超时时间？")])]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("如何估计RTT？")])]),t._v(" "),a("h2",{attrs:{id:"tcp-可靠数据传输"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-可靠数据传输"}},[t._v("#")]),t._v(" TCP 可靠数据传输")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("TCP在IP层提供的不可靠服务基础上实现可靠数据传输服务")])]),t._v(" "),a("li",[a("p",[t._v("流水线机制")])]),t._v(" "),a("li",[a("p",[t._v("累积确认")])]),t._v(" "),a("li",[a("p",[t._v("TCP使用单一重传定时器")])]),t._v(" "),a("li",[a("p",[t._v("触发重传的事件")]),t._v(" "),a("ul",[a("li",[t._v("超时")]),t._v(" "),a("li",[t._v("收到重复ACK")])])]),t._v(" "),a("li",[a("p",[t._v("渐进式")]),t._v(" "),a("ul",[a("li",[t._v("暂不考虑重复ACK")]),t._v(" "),a("li",[t._v("暂不考虑流量控制")]),t._v(" "),a("li",[t._v("暂不考虑拥塞控制")])])])]),t._v(" "),a("h3",{attrs:{id:"tcp-发送方事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-发送方事件"}},[t._v("#")]),t._v(" TCP 发送方事件")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("从应用层收到数据")])]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("超时")])]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("收到 ACK")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TCP 重传示例")]),t._v(" "),a("ul",[a("li",[t._v("Lost ACK scenario"),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("示意图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906172247-2021-09-06-17-22-47.png",alt:"20210906172247-2021-09-06-17-22-47"}})])])]),t._v(" "),a("li",[t._v("Premature timeout"),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("示意图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906172405-2021-09-06-17-24-05.png",alt:"20210906172405-2021-09-06-17-24-05"}})])])]),t._v(" "),a("li",[t._v("Cumulative ACK scenario"),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("示意图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906172711-2021-09-06-17-27-11.png",alt:"20210906172711-2021-09-06-17-27-11"}})])])])])]),t._v(" "),a("h3",{attrs:{id:"tcp-ack-生成rfc-568"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-ack-生成rfc-568"}},[t._v("#")]),t._v(" TCP ACK 生成[RFC 568]")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906173949-2021-09-06-17-39-49.png",alt:"20210906173949-2021-09-06-17-39-49"}})]),t._v(" "),a("h3",{attrs:{id:"快速重传机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速重传机制"}},[t._v("#")]),t._v(" 快速重传机制")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("如果sender收到对同一数据的3个ACK，则假定该数据之后的段已经丢失")])]),t._v(" "),a("li",[a("p",[t._v("为什么是 3 次?")])]),t._v(" "),a("li",[a("p",[t._v("快速重传算法")]),t._v(" "),a("ul",[a("li",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906174509-2021-09-06-17-45-09.png",alt:"20210906174509-2021-09-06-17-45-09"}})])])])]),t._v(" "),a("h2",{attrs:{id:"tcp-流量控制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-流量控制"}},[t._v("#")]),t._v(" TCP 流量控制")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("流量控制")]),t._v(" "),a("ul",[a("li",[t._v("发送方不能传输的太多、太快以至于淹没接收方（buffer溢出）")])])]),t._v(" "),a("li",[a("p",[t._v("RcvWindow = 0 的应对情况，参见教材 P165")])])]),t._v(" "),a("h2",{attrs:{id:"tcp-连接管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-连接管理"}},[t._v("#")]),t._v(" TCP 连接管理")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("TCP sender 和 receiver 在传输数据前需要建立连接")])]),t._v(" "),a("li",[a("p",[t._v("Client：连接发起者")])]),t._v(" "),a("li",[a("p",[t._v("Server: 等待客户连接请求")])]),t._v(" "),a("li",[a("p",[t._v("连接")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("SYN=1")])]),t._v(" "),a("li",[t._v("🌟 三次握手")])])]),t._v(" "),a("li",[a("p",[t._v("关闭")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("FIN")])]),t._v(" "),a("li",[t._v("两次挥手")])])]),t._v(" "),a("li",[a("p",[t._v("TCP client lifecycle")]),t._v(" "),a("ul",[a("li",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906180432-2021-09-06-18-04-32.png",alt:"20210906180432-2021-09-06-18-04-32"}})])])]),t._v(" "),a("li",[a("p",[t._v("TCP server lifecycle")]),t._v(" "),a("ul",[a("li",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210906180533-2021-09-06-18-05-33.png",alt:"20210906180533-2021-09-06-18-05-33"}})])])])])],1)}),[],!1,null,null,null);"function"==typeof l&&l(v);s.default=v.exports}}]);